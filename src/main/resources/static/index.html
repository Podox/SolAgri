<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Solar Panel Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="card shadow-lg">
        <div class="card-body">
            <h3 class="card-title text-center mb-4">Solar Panel Prediction Tool</h3>

            <form id="predictionForm">
                <div class="mb-3">
                    <label for="seedType" class="form-label">Type of Seed</label>
                    <input type="text" class="form-control" id="seedType" required>
                </div>

                <div class="mb-3">
                    <label for="waterDepth" class="form-label">Water Depth (in meters)</label>
                    <input type="number" class="form-control" id="waterDepth" required>
                </div>

                <div class="mb-3">
                    <label for="waterDistance" class="form-label">Water Travel Distance (in meters)</label>
                    <input type="number" class="form-control" id="waterDistance" required>
                </div>

                <button type="submit" class="btn btn-primary w-100">Predict</button>
            </form>

            <hr class="my-4">

            <div id="resultSection" class="d-none">
                <h5>Prediction Results:</h5>
                <ul class="list-group">
                    <li class="list-group-item">ğŸ”‹ <strong>Kilowatts Needed:</strong> <span id="kilowatts"></span></li>
                    <li class="list-group-item">ğŸª <strong>Number of Solar Panels:</strong> <span id="panels"></span></li>
                    <li class="list-group-item">ğŸ“ <strong>Surface Area (mÂ²):</strong> <span id="surfaceArea"></span></li>
                    <li class="list-group-item">ğŸ’° <strong>Estimated Cost (MAD):</strong> <span id="cost"></span></li>
                </ul>
            </div>

            <div id="errorMessage" class="alert alert-danger mt-4 d-none"></div>
        </div>
    </div>
</div>

<script>
    document.getElementById('predictionForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const seedType = document.getElementById('seedType').value;
        const waterDepth = document.getElementById('waterDepth').value;
        const waterDistance = document.getElementById('waterDistance').value;

        const prompt = `Je veux cultiver ${seedType}, la profondeur du puit de l'eau est de ${waterDepth} mÃ¨tres, et elle doit parcourir ${waterDistance} mÃ¨tres.`;

        fetch('/api/solar/predict', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ prompt })
        })
            .then(res => {
                if (!res.ok) throw new Error("Prediction failed");
                return res.json();
            })
            .then(data => {
                document.getElementById('kilowatts').textContent = data.kilowatts + " kW";
                document.getElementById('panels').textContent = data.panels;
                document.getElementById('surfaceArea').textContent = data.surfaceArea + " mÂ²";
                document.getElementById('cost').textContent = data.cost + " MAD";

                document.getElementById('resultSection').classList.remove('d-none');
                document.getElementById('errorMessage').classList.add('d-none');
            })
            .catch(err => {
                document.getElementById('errorMessage').textContent = "Error: " + err.message;
                document.getElementById('errorMessage').classList.remove('d-none');
                document.getElementById('resultSection').classList.add('d-none');
            });
    });
</script>

</body>
</html>
