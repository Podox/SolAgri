<!-- navbar -->
<app-navbar></app-navbar>


<!-- Support Page Content -->
<div class="max-w-5xl mx-auto p-6">
  <h2 class="text-3xl font-bold text-green-800 mb-6">Support Tickets</h2>

  <!-- Ticket Form -->
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4 bg-white p-6 rounded shadow-md border">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Subject</label>
      <input
        class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500"
        formControlName="subject"
        required />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
      <textarea
        class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500"
        rows="4"
        formControlName="description"
        required></textarea>
    </div>

    <button
      class="bg-green-600 text-white px-5 py-2 rounded hover:bg-green-700 transition disabled:opacity-50"
      [disabled]="form.invalid">
      Submit Ticket
    </button>
  </form>

  <!-- Error Message -->
  <div *ngIf="error" class="mt-4 text-red-600 bg-red-100 border border-red-300 px-4 py-2 rounded">
    {{ error }}
  </div>

  <!-- Tickets Table -->
  <div class="mt-10">
    <h4 class="text-xl font-semibold text-gray-800 mb-4">My Tickets</h4>

    <div *ngIf="tickets.length > 0" class="overflow-x-auto">
      <table class="min-w-full table-auto border-collapse border border-gray-200 rounded-lg overflow-hidden">
        <thead class="bg-gray-100 text-gray-700">
        <tr>
          <th class="px-4 py-2 text-left border-b border-gray-200">ID</th>
          <th class="px-4 py-2 text-left border-b border-gray-200">Subject</th>
          <th class="px-4 py-2 text-left border-b border-gray-200">Status</th>
          <th class="px-4 py-2 text-left border-b border-gray-200">Created</th>
          <th class="px-4 py-2 text-left border-b border-gray-200">Updated</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let t of tickets" class="hover:bg-gray-50">
          <td class="px-4 py-2 border-b border-gray-200">{{ t.id }}</td>
          <td class="px-4 py-2 border-b border-gray-200">{{ t.subject }}</td>
          <td class="px-4 py-2 border-b border-gray-200">{{ t.status }}</td>
          <td class="px-4 py-2 border-b border-gray-200">{{ t.createdAt | date:'short' }}</td>
          <td class="px-4 py-2 border-b border-gray-200">{{ t.updatedAt | date:'short' }}</td>
        </tr>
        </tbody>
      </table>
    </div>

    <p *ngIf="tickets.length === 0" class="text-gray-600 mt-4">No support tickets yet.</p>
  </div>
</div>
